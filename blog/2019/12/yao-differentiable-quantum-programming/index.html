<!doctype html>
<html lang="en">
<head>
	<!-- parts for all pages -->
	<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="author" content="Jeff Bezanson, Stefan Karpinski, Viral Shah, Alan Edelman, et al.">
<meta name="description" content="The official website for the Julia Language. Julia is a language that is fast, dynamic, easy to use, and open source. Click here to learn more.">
<meta name="robots" content="max-image-preview:large">
<meta name="twitter:site:id" content="1237720952"> <!-- @JuliaLanguage -->
<meta name="google-site-verification" content="9VDSjBtchQj6PQYIVwugTPY7pVCfLYgvkXiRHjc_Bzw" /> <!-- Google News Feed -->


	<link rel="icon" href="/assets/infra/julia.ico">

  <!-- Franklin stylesheets for generated pages -->
  
   <link rel="stylesheet" href="/libs/highlight/github.min.css">
  

	<!-- NOTE: specific stylesheets -->
<link rel="stylesheet" href="/libs/bootstrap/bootstrap.min.css">
<link rel="stylesheet" href="/css/app.css">
<link rel="stylesheet" href="/css/franklin.css">
<link rel="stylesheet" href="/css/fonts.css">
<link href="https://fonts.googleapis.com/css?family=Roboto:400,400i,500,500i,700,700i" rel="stylesheet">
<link href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
<script async defer src="/libs/buttons.js"></script>
<script src="/libs/clipboard.min.js"></script>
<script src="/libs/detectdark.js"></script>


<script defer data-domain="julialang.org" src="https://plausible.io/js/script.js"></script>

<!-- scripts for map rendering -->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"
integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A=="
crossorigin=""/>

<script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"
 integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA=="
 crossorigin=""></script>

<!-- https://github.com/Leaflet/Leaflet.markercluster -->
<script src="https://cdn.jsdelivr.net/npm/leaflet.markercluster@1.4.1/dist/leaflet.markercluster-src.min.js"></script>

<script src="https://kit.fontawesome.com/f030d443fe.js" crossorigin="anonymous"></script>


   <title>Yao.jl - Differentiable Quantum Programming In Julia</title>   

  
  <style>
	  .container ul li p {margin-bottom: 0;}
		.container ol li p {margin-bottom: 0;}
		.container ul ul {margin: .4em 0 .4em 0;}
		.container ul ol {margin: .4em 0 .4em 0;}
		.container ol ul {margin: .4em 0 .4em 0;}
		.container ol ol {margin: .4em 0 .4em 0;}
  </style>
  

  <!-- Specific style for blog pages (except the /blob/index) -->
  
  <style>
    .main { font-family: Georgia; }
    .main pre {
  	  margin-left: auto;
  	  margin-right: auto;
    }
    .main { width: 100%; font-size: 100%; }
    .main code { font-size: 90%; }
    .main pre code { font-size: 90%; }
    @media (min-width: 940px) {
      .main { width: 800px; }
      .container.blog-title { width: 800px;}
    }
  </style>
  

  <!-- OGP Metadata -->
	<meta property="og:title" content="Yao.jl - Differentiable Quantum Programming In Julia">
<meta property="og:description" content="Yao.jl - Differentiable Quantum Programming In Julia">
<meta property="og:image" content="/assets/images/julia-open-graph.png">


</head>

<body>

<nav class="navbar navbar-expand-lg navbar-light bg-white" id="main-menu">
  <div class="container">
      <a class="navbar-brand" href="/">
          <img src="/assets/infra/logo.svg" alt="JuliaLang Logo" height="40">
      </a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarContent" aria-controls="navbarContent" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarContent">
          <ul class="navbar-nav mx-auto mb-2 mb-lg-0">
              <li class="nav-item  ">
                  <a class="nav-link" href="/install/">Install</a>
              </li>
              <li class="nav-item">
                  <a class="nav-link" href="https://docs.julialang.org">Docs</a>
              </li>
              <li class="nav-item ">
                  <a class="nav-link" href="/learning/">Learn</a>
              </li>
              <li class="nav-item active">
                  <a class="nav-link" href="/blog/">Blog</a>
              </li>
              <li class="nav-item ">
                  <a class="nav-link" href="/community/">Community</a>
              </li>
              <li class="nav-item ">
                  <a class="nav-link" href="/contribute/">Contribute</a>
              </li>
              <li class="nav-item ">
                  <a class="nav-link" href="/jsoc/">JSoC</a>
              </li>
          </ul>
          <div class="navbar-action-buttons d-flex gap-4">
              <a class="github-button" href="https://github.com/JuliaLang/julia" data-icon="octicon-star" data-size="large" data-show-count="false" aria-label="Star JuliaLang/julia on GitHub">Star</a>
              <a class="github-button" href="https://github.com/sponsors/julialang" data-icon="octicon-heart" data-size="large" aria-label="Sponsor @julialang on GitHub">Sponsor</a>
          </div>
      </div>
  </div>
</nav>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>


<br><br>


<div class="container blog-title">
  <h1>Yao.jl - Differentiable Quantum Programming In Julia
    <a type="application/rss+xml" href="https://julialang.org/feed.xml">
      <i class="fa fa-rss-square rss-icon"></i>
    </a>
  </h1>
  <h3>
   <span style="font-weight: lighter;"> 28 December 2019 </span>
	|
	
	 <span style="font-weight: bold;"></span> 
  <!-- assumption that only one of the two is defined -->
   <span style="font-weight: bold;"><a href="https://rogerluo.me/">Xiu-Zhe (Roger) Luo</a> and <a href="https://github.com/GiggleLiu">Jin-Guo Liu</a> </span> 
  </h3>
</div>



<a href="https://github.com/JuliaLang/www.julialang.org/blob/master/blog/2019/12/yao-differentiable-quantum-programming.md" title="Edit this page on GitHub" class="edit-float">
</a>


<!-- Content appended here -->
<div class="container main"><p>We introduce <a href="https://yaoquantum.org/"><strong>Yao</strong></a> &#40;<a href="https://arxiv.org/abs/1912.10877">check our latest paper</a>&#41;, an open-source Julia package for solving practical problems in quantum computation research. The name Yao comes from the first Chinese character for unitary &#40;幺正&#41;.</p>

<div align="center"> <img
src="/assets/images/logo_yao.png"
alt="Yao Logo" width="210">
<p>The Logo of Yao</p>
</div>

<p>Why we created Yao? To be short, we are as greedy <a href="/blog/2012/02/why-we-created-julia/">as Julia itself</a>. We want something that is:</p>
<h3 id="differentiable"><a href="#differentiable" class="header-anchor">Differentiable</a></h3>
<p>Like many other Julia blog posts &#40;as well as the <a href="https://arxiv.org/abs/1907.07587">Zygote paper</a>&#41; have mentioned: gradients can be a better programmer than humans sometimes. In quantum computing, they can be used for variational algorithms, quantum control, gate learning, etc. Thus, we want to have differentiable programming on quantum circuits as well&#33;</p>
<p>However, automatic differentiation &#40;AD&#41; for quantum circuits is quite different from regular programs: the memory allocation cost in circuit simulation can be extremely high due to caching the intermediate states in the general context. And in forward mode AD, we need extra semantics to preserve the quantum circuit – so that it can be implemented on the real device.</p>
<p>In Yao, to accomplish this goal, we implemented a builtin <strong>domain-specific</strong> automatic differentiation &#40;AD&#41; engine to make use of the reversible nature of quantum circuits. The following is an example of a variational quantum eigensolver algorithm. With our efficient AD engine, you should be able to try it on your laptop</p>
<pre><code class="julia hljs"><span class="hljs-keyword">using</span> Yao, YaoExtensions
<span class="hljs-comment"># number of qubits and circuit depth</span>
n, d = <span class="hljs-number">16</span>, <span class="hljs-number">100</span>
circuit = dispatch!(variational_circuit(n, d),:random)

h = heisenberg(n)

<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-number">1</span>:<span class="hljs-number">100</span>
 _, grad = expect&#x27;(h, zero_state(n) =&gt; circuit)
 dispatch!(-, circuit, <span class="hljs-number">1e-1</span> * grad)
 println(<span class="hljs-string">&quot;Step <span class="hljs-variable">$i</span>, energy = <span class="hljs-subst">$(real.(expect(h, zero_state(n)</span>=&gt;circuit)))&quot;</span>)
<span class="hljs-keyword">end</span></code></pre>
<p>This example trains a 100 layer parametrized circuit &#40;4816 parameters&#41; to find the ground state of a 16 site Heisenberg model. The engine can also be integrated with general AD framework such as <a href="https://github.com/FluxML/Zygote.jl">Zygote</a> seamlessly, e.g., in our <a href="https://github.com/QuantumBFS/QuAlgorithmZoo.jl/blob/v0.1.0/examples/PortZygote/gate&#95;learning.jl">gate learning example</a>. We use differentiable programming to find the decomposition of a given unitary. You can learn more in our <a href="https://tutorials.yaoquantum.org/dev/">tutorial</a> and <a href="https://github.com/QuantumBFS/QuAlgorithmZoo.jl">Quantum Algorithm Zoo</a>.</p>
<h3 id="extensible"><a href="#extensible" class="header-anchor">Extensible</a></h3>
<p>New research ideas keep emerging every day and every hour. The field quantum software itself grows rapidly. We want a framework that is flexible enough for researchers and developers to extend it at any level for any possible type of research.</p>
<p>First, we designed and developed a hardware-free intermediate representation &#40;the Quantum Block Intermediate Representation, QBIR&#41; to represent and manipulate quantum circuits and a set of quantum register interface. This design enables one to extend Yao to customized algorithms, hardware and more by overloading the relevant interfaces. For example, while achieving the state-of-the-art performance as shown in next section, we extend our CUDA backend in <a href="https://github.com/QuantumBFS/CuYao.jl">CuYao</a> with only a few hundred lines of code written in native Julia with <a href="https://arxiv.org/abs/1712.03112">CUDAnative</a>. With some patches and syntax sugar, Yao just works with the symbolic engine <a href="https://github.com/symengine/SymEngine.jl">SymEngine</a> that allows you to differentiate, and calculate a quantum circuit with symbolic computation.</p>
<p>Second, like other projects in Julia, we make Yao extensible at the architecture level. The package Yao &#40;or its CUDA backend CuYao&#41; is only a meta-package that re-exports other component packages.  Developers can customize their own software with light-weight dependencies and develop new features rapidly.</p>
<h3 id="efficient"><a href="#efficient" class="header-anchor">Efficient</a></h3>
<p>Efficiency also matters especially in research that evolves numerical experiments, such as variational quantum algorithms. Besides all other exciting features, we still want this framework to achieve the-state-of-art performance in the simulation.</p>
<p>By making use of <a href="https://devblogs.nvidia.com/gpu-computing-julia-programming-language/">native GPU programming in Julia</a> and specialization based on multiple dispatch, Yao achieves state-of-the-art performance on intermediate-sized quantum circuits.</p>
<p><img src="https://docs.yaoquantum.org/dev/assets/images/relative_pcircuit.png" alt="relative" /></p>
<p><em>You can view a more <a href="https://github.com/Roger-luo/quantum-benchmarks/blob/master/RESULTS.md">detailed benchmark</a></em> here.</p>
<h2 id="whats_more"><a href="#whats_more" class="header-anchor">What&#39;s more?</a></h2>
<p>So far, we are happy to announce its birth, but the journey just starts.</p>
<p>We still want actual hardware compilation &#40;e.g. to <a href="https://github.com/QuantumBFS/YaoQASM.jl">OpenQASM</a>&#41;, circuit simplification and compilation &#40;<a href="https://github.com/QuantumBFS/YaoIR.jl">YaoIR</a>&#41;, visualization, tensor network &#40;check the <a href="https://yaoquantum.org/qbirplayground.html">online playground</a>&#41;, and more&#33;</p>
<p>Although some beta users helped us shape this software during <a href="https://yaoquantum.org/research/">real research work</a>, we still need more use cases to develop it further and more people to join us. If you are interested in this idea, <a href="https://github.com/QuantumBFS/Yao.jl/blob/master/CONTRIBUTING.md">join us</a>, and let&#39;s build a powerful tool for quantum computing research&#33;</p>
</div><br><br>

<!-- CONTENT ENDS HERE -->
    
    
        <script src="/libs/highlight/highlight.min.js"></script>


    

    <!-- http://tutsplus.github.io/clipboard/ -->

<script>
(function(){

	// Get the elements.
	// - the 'pre' element.
	// - the 'div' with the 'paste-content' id.

	var pre = document.getElementsByTagName('pre');

	// Add a copy button in the 'pre' element.
	// which only has the className of 'language-' or ' hljs'(if enable highlight.js pre-render).

	for (var i = 0; i < pre.length; i++) {
		var tag_name = pre[i].children[0].className
            	var isLanguage = tag_name.startsWith('language-') || tag_name.endsWith(' hljs');
		if ( isLanguage ) {
			var button           = document.createElement('button');
					button.className = 'copy-button';
					button.textContent = 'Copy';

					pre[i].appendChild(button);
		}
	};

	// Run Clipboard

	var copyCode = new Clipboard('.copy-button', {
		target: function(trigger) {
			return trigger.previousElementSibling;
    }
	});

	// On success:
	// - Change the "Copy" text to "Copied".
	// - Swap it to "Copy" in 2s.
	// - Lead user to the "contenteditable" area with Velocity scroll.

	copyCode.on('success', function(event) {
		event.clearSelection();
		event.trigger.textContent = 'Copied';
		window.setTimeout(function() {
			event.trigger.textContent = 'Copy';
		}, 2000);

	});

	// On error (Safari):
	// - Change the  "Press Ctrl+C to copy"
	// - Swap it to "Copy" in 2s.

	copyCode.on('error', function(event) {
		event.trigger.textContent = 'Press "Ctrl + C" to copy';
		window.setTimeout(function() {
			event.trigger.textContent = 'Copy';
		}, 5000);
	});

})();
</script>


    <footer class="container-fluid footer-copy">
  <div class="container">
    <div class="row footrow">
      <ul>
        <li><a href="/project">About</a></li>
        <li><a href="/about/help">Get Help</a></li>
        <li><a href="/governance/">Governance</a></li>
        <li><a href="/research/#publications">Publications</a></li>
        <li><a href="/community/sponsors/">Sponsors</a></li>
      </ul>
      <ul>
        <li><a href="/install/">Install</a></li>
        <li><a href="/downloads/">Manual Downloads</a></li>
        <li><a href="https://github.com/JuliaLang/julia">Source Code</a></li>
        <li><a href="/downloads/#current_stable_release">Current Stable Release</a></li>
        <li><a href="/downloads/#long_term_support_release">Longterm Support Release</a></li>
      </ul>
      <ul>
        <li><a href="https://docs.julialang.org/en/v1/">Documentation</a></li>
        <li><a href="https://juliaacademy.com">JuliaAcademy</a></li>
        <li><a href="https://www.youtube.com/user/JuliaLanguage">YouTube</a></li>
        <li><a href="/learning/getting-started/">Getting Started</a></li>
        <li><a href="https://docs.julialang.org/en/v1/manual/faq/">FAQ</a></li>
        <li><a href="/learning/books">Books</a></li>
      </ul>
      <ul>
        <li><a href="/community/">Community</a></li>
        <li><a href="/community/standards/">Code of Conduct</a></li>
        <li><a href="/community/stewards/">Stewards</a></li>
        <li><a href="/diversity/">Diversity</a></li>
        <li><a href="https://juliagenderinclusive.github.io">Julia Gender Inclusive</a></li>
        <li><a href="https://juliacon.org">JuliaCon</a></li>
        <li><a href="/community/#julia_user_and_developer_survey">User/Developer Survey</a></li>
        <li><a href="/shop/">Shop Merchandise</a></li>
      </ul>
      <ul>
        <li><a href="https://github.com/JuliaLang/julia/blob/master/CONTRIBUTING.md">Contributing</a></li>
        <li><a href="/contribute">Contributor's Guide</a></li>
        <li><a href="https://github.com/JuliaLang/julia/issues">Issue Tracker</a></li>
        <li><a href="https://github.com/JuliaLang/julia/security/policy">Report a Security Issue</a></li>
        <li><a href="https://github.com/search?q=is%3Aopen+is%3Aissue+language%3AJulia+label%3A%22help+wanted%22">Help Wanted Issues</a></li>
        <li><a href="https://github.com/search?q=is%3Aopen+is%3Aissue+language%3AJulia+label%3A%22good+first+issue%22">Good First Issue</a></li>
        <li><a href="https://docs.julialang.org/en/v1/devdocs/init/">Dev Docs</a></li>
      </ul>
    </div>
    <div id="footer-bottom" class="row">
      <div class="col-md-10 py-2">
        <p>This site is powered by <a href="https://www.netlify.com">Netlify</a>, <a href="https://franklinjl.org">Franklin.jl</a>, and the <a href="https://julialang.org">Julia Programming Language</a>.</p>
        <p>We thank <a href="https://www.fastly.com">Fastly</a> for their generous infrastructure support.</p>
        <p>©2024 JuliaLang.org <a href="https://github.com/JuliaLang/www.julialang.org/graphs/contributors">contributors</a>. The content on this website is made available under the <a href="https://github.com/JuliaLang/www.julialang.org/blob/master/LICENSE.md">MIT license</a>.</p>
      </div>
      <div class="col-md-2 py-2">
        <span class="float-sm-right">
          <a class="github-button" href="https://github.com/sponsors/julialang" data-icon="octicon-heart" data-size="large" aria-label="Sponsor @julialang on GitHub">Sponsor</a>
        </span>
      </div>
    </div>
  </div>
</footer>

<script src="/libs/jquery/jquery.min.js"></script>
<script src="/libs/bootstrap/bootstrap.min.js"></script>
<!-- <script src="/libs/highlight/highlight.min.js"></script> -->
<!--  -->

    <script src="/libs/groups.js"></script>
    <script src="/libs/map.js"></script>
  </body>
</html>
