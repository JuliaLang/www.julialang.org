<!doctype html>
<html lang="en">
<head>
	<!-- parts for all pages -->
	<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="author" content="Jeff Bezanson, Stefan Karpinski, Viral Shah, Alan Edelman, et al.">
<meta name="description" content="The official website for the Julia Language. Julia is a language that is fast, dynamic, easy to use, and open source. Click here to learn more.">
<meta name="robots" content="max-image-preview:large">
<meta name="twitter:site:id" content="1237720952"> <!-- @JuliaLanguage -->
<meta name="google-site-verification" content="9VDSjBtchQj6PQYIVwugTPY7pVCfLYgvkXiRHjc_Bzw" /> <!-- Google News Feed -->


	<link rel="icon" href="/previews/PR2358/assets/infra/julia.ico">

  <!-- Franklin stylesheets for generated pages -->
   <link rel="stylesheet" href="/previews/PR2358/libs/katex/katex.min.css">
      
   <link rel="stylesheet" href="/previews/PR2358/libs/highlight/github.min.css">
  

	<!-- NOTE: specific stylesheets -->
<link rel="stylesheet" href="/previews/PR2358/libs/bootstrap/bootstrap.min.css">
<link rel="stylesheet" href="/previews/PR2358/css/app.css">
<link rel="stylesheet" href="/previews/PR2358/css/franklin.css">
<link rel="stylesheet" href="/previews/PR2358/css/fonts.css">
<link href="https://fonts.googleapis.com/css?family=Roboto:400,400i,500,500i,700,700i" rel="stylesheet">
<link href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
<script async defer src="/previews/PR2358/libs/buttons.js"></script>
<script src="/previews/PR2358/libs/clipboard.min.js"></script>
<script src="/previews/PR2358/libs/detectdark.js"></script>


<script defer data-domain="julialang.org" src="https://plausible.io/js/script.js"></script>

<!-- scripts for map rendering -->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"
integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A=="
crossorigin=""/>

<script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"
 integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA=="
 crossorigin=""></script>

<!-- https://github.com/Leaflet/Leaflet.markercluster -->
<script src="https://cdn.jsdelivr.net/npm/leaflet.markercluster@1.4.1/dist/leaflet.markercluster-src.min.js"></script>

<script src="https://kit.fontawesome.com/f030d443fe.js" crossorigin="anonymous"></script>


   <title>GSoC 2017 Project: Hamiltonian Indirect Inference</title>   

  
  <style>
	  .container ul li p {margin-bottom: 0;}
		.container ol li p {margin-bottom: 0;}
		.container ul ul {margin: .4em 0 .4em 0;}
		.container ul ol {margin: .4em 0 .4em 0;}
		.container ol ul {margin: .4em 0 .4em 0;}
		.container ol ol {margin: .4em 0 .4em 0;}
  </style>
  

  <!-- Specific style for blog pages (except the /blob/index) -->
  
  <style>
    .main { font-family: Georgia; }
    .main pre {
  	  margin-left: auto;
  	  margin-right: auto;
    }
    .main { width: 100%; font-size: 100%; }
    .main code { font-size: 90%; }
    .main pre code { font-size: 90%; }
    @media (min-width: 940px) {
      .main { width: 800px; }
      .container.blog-title { width: 800px;}
    }
  </style>
  

  <!-- OGP Metadata -->
	<meta property="og:title" content="GSoC 2017 Project: Hamiltonian Indirect Inference">
<meta property="og:description" content=" GSoC 2017 Project: Hamiltonian Indirect Inference | This is a writeup of my project for the Google Summer of Code 2017. The... ">
<meta property="og:image" content="/assets/images/julia-open-graph.png">


</head>

<body>

<nav class="navbar navbar-expand-lg navbar-light bg-white" id="main-menu">
  <div class="container">
      <a class="navbar-brand" href="/previews/PR2358/">
          <img src="/previews/PR2358/assets/infra/logo.svg" alt="JuliaLang Logo" class="navbarjulialogo" height="40">
      </a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarContent" aria-controls="navbarContent" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarContent">
          <ul class="navbar-nav mx-auto mb-2 mb-lg-0">
              <li class="nav-item  ">
                  <a class="nav-link" href="/previews/PR2358/install/">Install</a>
              </li>
              <li class="nav-item">
                  <a class="nav-link" href="https://docs.julialang.org">Docs</a>
              </li>
              <li class="nav-item ">
                  <a class="nav-link" href="/previews/PR2358/learning/">Learn</a>
              </li>
              <li class="nav-item active">
                  <a class="nav-link" href="/previews/PR2358/blog/">Blog</a>
              </li>
              <li class="nav-item ">
                  <a class="nav-link" href="/previews/PR2358/community/">Community</a>
              </li>
              <li class="nav-item ">
                  <a class="nav-link" href="/previews/PR2358/contribute/">Contribute</a>
              </li>
              <li class="nav-item ">
                  <a class="nav-link" href="/previews/PR2358/jsoc/">JSoC</a>
              </li>
          </ul>
          <div class="navbar-action-buttons d-flex gap-4">
              <a class="github-button" href="https://github.com/JuliaLang/julia" data-icon="octicon-star" data-size="large" data-show-count="false" aria-label="Star JuliaLang/julia on GitHub">Star</a>
              <a class="github-button" href="https://github.com/sponsors/julialang" data-icon="octicon-heart" data-size="large" aria-label="Sponsor @julialang on GitHub">Sponsor</a>
          </div>
      </div>
  </div>
</nav>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>


<br><br>


<div class="container blog-title">
  <h1>GSoC 2017 Project: Hamiltonian Indirect Inference
    <a type="application/rss+xml" href="https://julialang.org/feed.xml">
      <i class="fa fa-rss-square rss-icon"></i>
    </a>
  </h1>
  <h3>
   <span style="font-weight: lighter;"> 19 September 2017 </span>
	|
	
	 <span style="font-weight: bold;"></span> 
  <!-- assumption that only one of the two is defined -->
   <span style="font-weight: bold;">Dorisz Albrecht </span> 
  </h3>
</div>



<a href="https://github.com/JuliaLang/www.julialang.org/blob/master/blog/2017/09/Hamiltonian-Indirect-Inference.md" title="Edit this page on GitHub" class="edit-float">
</a>


<!-- Content appended here -->
<div class="container main"><p>This is a writeup of my project for the Google Summer of Code 2017. The associated repository contains examples of estimating various models. In addition to this repository, I have collaborated in <a href="https://github.com/tpapp/HamiltonianABC.jl/">HamiltonianABC</a> and its branches as part of the GSOC 2017. See also <a href="https://github.com/DoriszAlbrecht/Bayesian_Examples.jl">Bayesian_Examples.jl</a>.</p>
<div class="franklin-toc"><ol><li><a href="#gsoc_2017_project_hamiltonian_monte_carlo_and_pseudo-bayesian_indirect_likelihood">GSOC 2017 project: Hamiltonian Monte Carlo and pseudo-Bayesian Indirect Likelihood</a></li><li><a href="#parametric_bayesian_indirect_likelihood_for_the_full_data">Parametric Bayesian Indirect Likelihood for the Full Data</a></li><li><a href="#first_stage_of_my_project">First stage of my project</a></li><li><a href="#second_stage_of_my_project">Second stage of my project</a></li><li><a href="#stochastic_volatility_model">Stochastic Volatility model</a></li><li><a href="#problems_that_i_have_faced_during_gsoc">Problems that I have faced during GSOC</a><ol><li><a href="#1_difficult_auxiliary_model">1 Difficult auxiliary model</a></li><li><a href="#2_type-stability_issues">2 Type-stability issues</a></li></ol></li><li><a href="#future_work">Future work</a></li><li><a href="#references">References</a></li></ol></div>
<h2 id="gsoc_2017_project_hamiltonian_monte_carlo_and_pseudo-bayesian_indirect_likelihood"><a href="#gsoc_2017_project_hamiltonian_monte_carlo_and_pseudo-bayesian_indirect_likelihood" class="header-anchor">GSOC 2017 project: Hamiltonian Monte Carlo and pseudo-Bayesian Indirect Likelihood</a></h2>
<p>This summer I have had the opportunity to participate in the Google Summer of Code program. My project was in the Julia language and the main goal was to implement Indirect Inference &#40;A. A. Smith 1993; A. Smith 2008&#41; to overcome the typically arising issues &#40;such as intractable or costly to compute likelihoods&#41; when estimating models using likelihood-based methods. Hamiltonian Monte Carlo was expected to result in a more efficient sampling process.</p>
<p>Under the mentorship of Tam√°s K. Papp, I completed a major revision of Bayesian estimation methods using Indirect Inference &#40;II&#41; and Hamiltonian Monte Carlo. I also got familiar with using git, opening issues, creating a repository among others.</p>
<p>Here I introduce the methods with a bit of context, and discuss an example more extensively.</p>
<h2 id="parametric_bayesian_indirect_likelihood_for_the_full_data"><a href="#parametric_bayesian_indirect_likelihood_for_the_full_data" class="header-anchor">Parametric Bayesian Indirect Likelihood for the Full Data</a></h2>
<p>Usually when we face an intractable likelihood or a likelihood that would be extremely costly to calculate, we have the option to use an alternative auxiliary model to extract and estimate the parameters of interest. These alternative models should be easier to deal with. Drovandi et al. reviews a collection of parametric Bayesian Indirect Inference &#40;pBII&#41; methods, I focused on the parametric Bayesian Indirect Likelihood for the Full Data &#40;pdBIL&#41; method proposed by Gallant and McCulloch &#40;2009&#41;. The pdBIL uses the likelihood of the auxiliary model as a substitute for the intractable likelihood. The pdBIL does not compare summary statistics, instead works in the following way:</p>
<p>First the data is generated, once we have the data, we can estimate the parameters of the auxiliary model. Then, the estimated parameters are put into the auxiliary likelihood with the observed/generated data. Afterwards we can use this likelihood in our chosen Bayesian method i.e. MCMC.</p>
<p>To summarize the method, first we have the parameter vector <span class="katex"><span class="katex-mathml"><math xmlns="https://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œ∏</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">Œ∏</span></span></span></span> and the observed data y. We would like to calculate the likelihood of <span class="katex"><span class="katex-mathml"><math xmlns="https://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">‚Ñì</mi><mo stretchy="false">(</mo><mi>Œ∏</mi><mi mathvariant="normal">‚à£</mi><mi>y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\ell(\theta|y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">‚Ñì</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">Œ∏</span><span class="mord">‚à£</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span>, but it is intractable or costly to compute. In this case, with pdBIL we have to find an auxiliary model &#40;A&#41; that we use to approximate the true likelihood in the following way:</p>
<ul>
<li><p>First we have to generate points, denote with <strong>x*</strong> from the data generating process with the previously proposed parameters <span class="katex"><span class="katex-mathml"><math xmlns="https://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œ∏</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">Œ∏</span></span></span></span>.</p>
</li>
<li><p>Then we compute the MLE of the auxiliary likelihood under <strong>x</strong> to get the parameters denoted by <span class="katex"><span class="katex-mathml"><math xmlns="https://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>œï</mi></mrow><annotation encoding="application/x-tex">\phi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">œï</span></span></span></span>.</p>
</li>
</ul>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="https://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>œï</mi><mo stretchy="false">(</mo><msup><mi>x</mi><mo lspace="0em" rspace="0em">‚ãÜ</mo></msup><mo stretchy="false">)</mo><mo>=</mo><munder><mo><mi mathvariant="normal">arg‚Äâmax</mi><mo>‚Å°</mo></mo><mi>œï</mi></munder><mo stretchy="false">(</mo><msup><mi>x</mi><mo lspace="0em" rspace="0em">‚ãÜ</mo></msup><mi mathvariant="normal">‚à£</mi><mi>œï</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\phi(x^{\star}) = \argmax_{\phi} (x^{\star}|\phi)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">œï</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.738696em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">‚ãÜ</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.832656em;vertical-align:-1.082656em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.43055999999999983em;"><span style="top:-2.153452em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">œï</span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop"><span class="mord mathrm">a</span><span class="mord mathrm">r</span><span class="mord mathrm" style="margin-right:0.01389em;">g</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathrm">m</span><span class="mord mathrm">a</span><span class="mord mathrm">x</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:1.082656em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.738696em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">‚ãÜ</span></span></span></span></span></span></span></span></span><span class="mord">‚à£</span><span class="mord mathdefault">œï</span><span class="mclose">)</span></span></span></span></span>
<ul>
<li><p>Under these parameters <span class="katex"><span class="katex-mathml"><math xmlns="https://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>œï</mi></mrow><annotation encoding="application/x-tex">\phi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">œï</span></span></span></span>, we can now compute the likelihood of <span class="katex"><span class="katex-mathml"><math xmlns="https://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="normal">‚Ñì</mi><mi>A</mi></msub><mo stretchy="false">(</mo><mi>y</mi><mi mathvariant="normal">‚à£</mi><mi>œï</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\ell_{A}(y|\phi)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord">‚Ñì</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">A</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mord">‚à£</span><span class="mord mathdefault">œï</span><span class="mclose">)</span></span></span></span>. It is desirable to have the auxiliary likelihood as close to the true likelihood as possible, in the sense of capturing relevant aspects of the model and the generated data.</p>
</li>
</ul>
<h2 id="first_stage_of_my_project"><a href="#first_stage_of_my_project" class="header-anchor">First stage of my project</a></h2>
<p>In the first stage of my project I coded two models from Drovandi et al. using pdBIL. After calculating the likelihood of the auxiliary model, I used a Random Walk Metropolis-Hastings MCMC to sample from the target distribution, resulting in <a href="https://github.com/tpapp/HamiltonianABC.jl/tree/dorisz-toy-models">Toy models</a>. In this stage of the project, the methods I used were well-known. The purpose of the replication of the toy models from Drovandi et al. was to find out what issues we might face later on and to come up with a usable interface. This stage resulted in <a href="https://github.com/tpapp/HamiltonianABC.jl/">HamiltonianABC</a> &#40;collaboration with Tam√°s K. Papp&#41;.</p>
<h2 id="second_stage_of_my_project"><a href="#second_stage_of_my_project" class="header-anchor">Second stage of my project</a></h2>
<p>After the first stage, I worked through Betancourt &#40;2017&#41; and did a code revision for Tam√°s K. Papp&#39;s <a href="https://github.com/tpapp/DynamicHMC.jl">DynamicHMC.jl</a> which consisted of checking the code and its comparison with the paper. In addition to using the Hamiltonian Monte Carlo method, the usage of the forward mode automatic differentiation of the ForwardDiff package was the other main factor of this stage. The novelty of this project was to find a way to fit every component together in a way to get an efficient estimation out of it. The biggest issue was to define type-stable functions such that to accelerate the sampling process.</p>
<h2 id="stochastic_volatility_model"><a href="#stochastic_volatility_model" class="header-anchor">Stochastic Volatility model</a></h2>
<p>After the second stage, I coded economic models for the <a href="https://github.com/tpapp/DynamicHMC.jl">DynamicHMC.jl</a>. The Stochastic Volatility model is one of them. In the following section, I will go through the set up.</p>
<p>The continuous-time version of the Ornstein-Ulenbeck Stochastic - volatility model describes how the return at time t has mean zero and its volatility is governed by a continuous-time Ornstein-Ulenbeck process of its variance. The big fluctuation of the value of a financial product imply a varying volatility process. That is why we need stochastic elements in the model. As we can access data only in discrete time, it is natural to take the discretization of the model.</p>
<p>The discrete-time version of the Ornstein-Ulenbeck Stochastic - volatility model:</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="https://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>t</mi></msub><mo>=</mo><msub><mi>x</mi><mi>t</mi></msub><mo>+</mo><msub><mi>œµ</mi><mi>t</mi></msub><mspace width="1em"/><mtext>where</mtext><mspace width="1em"/><msub><mi>œµ</mi><mi>t</mi></msub><mo>‚àº</mo><msup><mi mathvariant="normal">X</mi><mn>2</mn></msup><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">y_{t} = x_{t} + \epsilon_{t} \quad \text{where}\quad \epsilon_{t} ‚àº \Chi^{2}(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">œµ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord text"><span class="mord">where</span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord"><span class="mord mathdefault">œµ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">‚àº</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">X</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span></span>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="https://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>t</mi></msub><mo>=</mo><mi>œÅ</mi><mo>‚àó</mo><msub><mi>x</mi><mrow><mi>t</mi><mo>‚àí</mo><mn>1</mn></mrow></msub><mo>+</mo><mi>œÉ</mi><mo>‚àó</mo><msub><mi>ŒΩ</mi><mi>t</mi></msub><mspace width="1em"/><mtext>where</mtext><mspace width="1em"/><msub><mi>ŒΩ</mi><mi>t</mi></msub><mo>‚àº</mo><mi mathvariant="script">N</mi><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">x_{t} = \rho * x_{t-1} + \sigma * \nu_{t}  \quad \text{where}\quad \nu_{t} ‚àº \mathcal N(0, 1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.6597200000000001em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">œÅ</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">‚àó</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.791661em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">‚àí</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">œÉ</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">‚àó</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.06366em;">ŒΩ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.06366em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord text"><span class="mord">where</span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.06366em;">ŒΩ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.06366em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">‚àº</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathcal" style="margin-right:0.14736em;">N</span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></span>
<p>The discrete-time version was used as the data-generating process. Where <span class="katex"><span class="katex-mathml"><math xmlns="https://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">y_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> denotes the logarithm of return, <span class="katex"><span class="katex-mathml"><math xmlns="https://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">x_{t}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> is the logarithm of variance, while <span class="katex"><span class="katex-mathml"><math xmlns="https://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>œµ</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\epsilon_{t}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">œµ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="https://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ŒΩ</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\nu_{t}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.06366em;">ŒΩ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.06366em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> are unobserved noise terms.</p>
<p>For the auxiliary model, we used two regressions. The first regression was an AR&#40;2&#41; process on the first differences, the second was also an AR&#40;2&#41; process on the original variables in order to capture the levels.</p>
<pre><code class="julia hljs"><span class="hljs-string">&quot;&quot;&quot;
    lag_matrix(xs, ns, K = maximum(ns))

Matrix with differently lagged xs.
&quot;&quot;&quot;</span>
<span class="hljs-keyword">function</span> lag_matrix(xs, ns, K = maximum(ns))
    M = <span class="hljs-built_in">Matrix</span>{eltype(xs)}(length(xs)-K, maximum(ns))
    <span class="hljs-keyword">for</span> i ‚àà ns
        M[:, i] = lag(xs, i, K)
    <span class="hljs-keyword">end</span>
    M
<span class="hljs-keyword">end</span>

<span class="hljs-string">&quot;first auxiliary regression y, X, meant to capture first differences&quot;</span>
<span class="hljs-keyword">function</span> yX1(zs, K)
    Œîs = diff(zs)
    lag(Œîs, <span class="hljs-number">0</span>, K), hcat(lag_matrix(Œîs, <span class="hljs-number">1</span>:K, K), ones(eltype(zs), length(Œîs)-K), lag(zs, <span class="hljs-number">1</span>, K+<span class="hljs-number">1</span>))
<span class="hljs-keyword">end</span>

<span class="hljs-string">&quot;second auxiliary regression y, X, meant to capture levels&quot;</span>
<span class="hljs-keyword">function</span> yX2(zs, K)
    lag(zs, <span class="hljs-number">0</span>, K), hcat(ones(eltype(zs), length(zs)-K), lag_matrix(zs, <span class="hljs-number">1</span>:K, K))
<span class="hljs-keyword">end</span></code></pre>
<p>The AR&#40;2&#41; process of the first differences can be summarized by:</p>
<p>Given a series Y, it is the first difference of the first difference. The so called &quot;change in the change&quot; of Y at time t. The second difference of a discrete function can be interpreted as the second derivative of a continuous function, which is the &quot;acceleration&quot; of the function at a point in time t. In this model, we want to capture the &quot;acceleration&quot; of the logarithm of return.</p>
<p>The AR&#40;2&#41; process of the original variables is needed to capture the effect of <span class="katex"><span class="katex-mathml"><math xmlns="https://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>œÅ</mi></mrow><annotation encoding="application/x-tex">\rho</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">œÅ</span></span></span></span>. It turned out that the impact of œÅ was rather weak in the AR&#40;2&#41; process of the first differences . That is why we need a second auxiliary model.</p>
<p>I will now describe the required steps for the estimation of the parameters of interest in the stochastic volatility model with the Dynamic Hamiltonian Monte Carlo method. First we need a callable Julia object which gives back the logdensity and the gradient in DiffResult type. After that, we write a function that computes the density, then we calculate its gradient using the ForwardDiff package in a wrapper function.</p>
<p>Required packages for the StochasticVolatility model:</p>
<pre><code class="julia hljs"><span class="hljs-keyword">using</span> ArgCheck
<span class="hljs-keyword">using</span> Distributions
<span class="hljs-keyword">using</span> Parameters
<span class="hljs-keyword">using</span> DynamicHMC
<span class="hljs-keyword">using</span> StatsBase
<span class="hljs-keyword">using</span> Base.Test
<span class="hljs-keyword">using</span> ContinuousTransformations
<span class="hljs-keyword">using</span> DiffWrappers
<span class="hljs-keyword">import</span> Distributions: Uniform, InverseGamma</code></pre>
<ul>
<li><p>First, we define a structure. This structure should contain the observed data, the priors, the shocks and the transformation performed on the parameters, but the components may vary depending on the estimated model.</p>
</li>
</ul>
<pre><code class="julia hljs"><span class="hljs-keyword">struct</span> StochasticVolatility{T, Prior_œÅ, Prior_œÉ, Ttrans}
    <span class="hljs-string">&quot;observed data&quot;</span>
    ys::<span class="hljs-built_in">Vector</span>{T}
    <span class="hljs-string">&quot;prior for œÅ (persistence)&quot;</span>
    prior_œÅ::Prior_œÅ
    <span class="hljs-string">&quot;prior for œÉ_v (volatility of volatility)&quot;</span>
    prior_œÉ::Prior_œÉ
    <span class="hljs-string">&quot;œá^2 draws for simulation&quot;</span>
    œµ::<span class="hljs-built_in">Vector</span>{T}
    <span class="hljs-string">&quot;Normal(0,1) draws for simulation&quot;</span>
    ŒΩ::<span class="hljs-built_in">Vector</span>{T}
    <span class="hljs-string">&quot;Transformations cached&quot;</span>
    transformation::Ttrans
<span class="hljs-keyword">end</span></code></pre>
<p>After specifying the data generating function and a couple of facilitator and additional functions for the particular model &#40;whole module can be found in <em>src</em> folder&#41;, we can make the model structure callable, returning the log density. The logjac is needed because of the transformation we make on the parameters.</p>
<pre><code class="julia hljs"><span class="hljs-keyword">function</span> (pp::StochasticVolatility)(Œ∏)
    <span class="hljs-meta">@unpack</span> ys, prior_œÅ, prior_œÉ, ŒΩ, œµ, transformation = pp
    œÅ, œÉ = transformation(Œ∏)
    logprior = logpdf(prior_œÅ, œÅ) + logpdf(prior_œÉ, œÉ)
    N = length(œµ)

    <span class="hljs-comment"># Generating xs, which is the latent volatility process</span>

    xs = simulate_stochastic(œÅ, œÉ, œµ, ŒΩ)
    Y_1, X_1 = yX1(xs, <span class="hljs-number">2</span>)
    Œ≤‚ÇÅ = qrfact(X_1, <span class="hljs-built_in">Val</span>{<span class="hljs-literal">true</span>}) \ Y_1
    v‚ÇÅ = mean(abs2,  Y_1 - X_1*Œ≤‚ÇÅ)
    Y_2, X_2 = yX2(xs, <span class="hljs-number">2</span>)
    Œ≤‚ÇÇ = qrfact(X_2, <span class="hljs-built_in">Val</span>{<span class="hljs-literal">true</span>}) \ Y_2
    v‚ÇÇ = mean(abs2,  Y_2 - X_2*Œ≤‚ÇÇ)
    <span class="hljs-comment"># We work with first differences</span>
    y‚ÇÅ, X‚ÇÅ = yX1(ys, <span class="hljs-number">2</span>)
    log_likelihood1 = sum(logpdf.(Normal(<span class="hljs-number">0</span>, ‚àöv‚ÇÅ), y‚ÇÅ - X‚ÇÅ * Œ≤‚ÇÅ))
    y‚ÇÇ, X‚ÇÇ = yX2(ys, <span class="hljs-number">2</span>)
    log_likelihood2 = sum(logpdf.(Normal(<span class="hljs-number">0</span>, ‚àöv‚ÇÇ), y‚ÇÇ - X‚ÇÇ * Œ≤‚ÇÇ))
    logprior + log_likelihood1 + log_likelihood2 + logjac(transformation, Œ∏)
<span class="hljs-keyword">end</span></code></pre>
<p>We need the transformations because the parameters are in the proper subset of <span class="katex"><span class="katex-mathml"><math xmlns="https://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="normal">‚Ñú</mi><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">\Re^{n}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord"><span class="mord">‚Ñú</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span></span></span></span></span>, but we want to use <span class="katex"><span class="katex-mathml"><math xmlns="https://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="normal">‚Ñú</mi><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">\Re^{n}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord"><span class="mord">‚Ñú</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span></span></span></span></span>. The ContinuousTransformation package is used for the transformations. We save the transformations such that the callable object stays type-stable which makes the process faster.</p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="https://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ŒΩ</mi></mrow><annotation encoding="application/x-tex">\nu</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.06366em;">ŒΩ</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="https://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>œµ</mi></mrow><annotation encoding="application/x-tex">\epsilon</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">œµ</span></span></span></span> are random variables which we use after the transformation to simulate observation points. This way the simulated variables are continuous in the parameters and the posterior is differentiable.</p>
<p>Given the defined functions, we can now start the estimation and sampling process:</p>
<pre><code class="julia hljs">RNG = Base.Random.GLOBAL_RNG
<span class="hljs-comment"># true parameters and observed data</span>
œÅ = <span class="hljs-number">0.8</span>
œÉ = <span class="hljs-number">0.6</span>
y = simulate_stochastic(œÅ, œÉ, <span class="hljs-number">10000</span>)
<span class="hljs-comment"># setting up the model</span>
model = StochasticVolatility(y, Uniform(-<span class="hljs-number">1</span>, <span class="hljs-number">1</span>), InverseGamma(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>), <span class="hljs-number">10000</span>)
<span class="hljs-comment"># we start the estimation process from the true values</span>
Œ∏‚ÇÄ = inverse(model.transformation, (œÅ, œÉ))
<span class="hljs-comment"># wrap for gradient calculations</span>
fgw = ForwardGradientWrapper(model, Œ∏‚ÇÄ)
<span class="hljs-comment"># sampling</span>
sample, tuned_sampler = NUTS_tune_and_mcmc(RNG, fgw, <span class="hljs-number">5000</span>; q = Œ∏‚ÇÄ)</code></pre>
<p>The following graphs show the results for the parameters:</p>
<p><img src="/previews/PR2358/assets/blog/2017-09-19-Hamiltonian-Indirect-Inference/rho_plot.png" alt="rho_plot" /></p>
<p><img src="/previews/PR2358/assets/blog/2017-09-19-Hamiltonian-Indirect-Inference/sigma_plot.png" alt="sigma_plot" /></p>
<p>Analysing the graphs above, we can say that the posterior values are in rather close to the true values. Also worth mentioning that the priors do not affect the posterior values.</p>
<h2 id="problems_that_i_have_faced_during_gsoc"><a href="#problems_that_i_have_faced_during_gsoc" class="header-anchor">Problems that I have faced during GSOC</a></h2>
<h3 id="1_difficult_auxiliary_model"><a href="#1_difficult_auxiliary_model" class="header-anchor">1 Difficult auxiliary model</a></h3>
<ul>
<li><p>The true model was the g-and-k quantile function described by Rayner and MacGillivray &#40;2002&#41;.</p>
</li>
<li><p>The auxiliary model was a three component normal mixture model.</p>
</li>
</ul>
<p>We faced serious problems with this model.</p>
<p>First of all, I coded the MLE of the finite component normal mixture model, which computes the means, variances and weights of the normals given the observed data and the desired number of mixtures. With the g-and-k quantile function, I experienced the so called &quot;isolation&quot;, which means that one observation point is an outlier getting weight 1, the other observed points get weight <span class="katex"><span class="katex-mathml"><math xmlns="https://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œ∏</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">Œ∏</span></span></span></span>, which results in variance equal to <span class="katex"><span class="katex-mathml"><math xmlns="https://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œ∏</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">Œ∏</span></span></span></span>. There are ways to disentangle the problem of isolation, but the parameters of interests still did not converge to the true values. There is work to be done with this model.</p>
<h3 id="2_type-stability_issues"><a href="#2_type-stability_issues" class="header-anchor">2 Type-stability issues</a></h3>
<p>To use the automatic differentiation method efficiently, I had to code the functions to be type-stable, otherwise the sampling functions would have taken hours to run. See the following example:</p>
<ul>
<li><p>This is not type-stable</p>
</li>
</ul>
<pre><code class="julia hljs"><span class="hljs-keyword">function</span> simulate_stochastic(œÅ, œÉ, œµs, ŒΩs)
    N = length(œµs)
    <span class="hljs-meta">@argcheck</span> N == length(ŒΩs)
    xs = <span class="hljs-built_in">Vector</span>(N)
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-number">1</span>:N
        xs[i] = (i == <span class="hljs-number">1</span>) ? ŒΩs[<span class="hljs-number">1</span>]*œÉ*(<span class="hljs-number">1</span> - œÅ^<span class="hljs-number">2</span>)^(-<span class="hljs-number">0.5</span>) : (œÅ*xs[i-<span class="hljs-number">1</span>] + œÉ*ŒΩs[i])
    <span class="hljs-keyword">end</span>
    xs + log.(œµs) + <span class="hljs-number">1.27</span>
<span class="hljs-keyword">end</span></code></pre>
<ul>
<li><p>This is type-stable</p>
</li>
</ul>
<pre><code class="julia hljs"><span class="hljs-keyword">function</span> simulate_stochastic(œÅ, œÉ, œµs, ŒΩs)
    N = length(œµs)
    <span class="hljs-meta">@argcheck</span> N == length(ŒΩs)
    x‚ÇÄ = ŒΩs[<span class="hljs-number">1</span>]*œÉ*(<span class="hljs-number">1</span> - œÅ^<span class="hljs-number">2</span>)^(-<span class="hljs-number">0.5</span>)
¬† ¬† xs = <span class="hljs-built_in">Vector</span>{typeof(x‚ÇÄ)}(N)
¬† ¬† <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-number">1</span>:N
¬† ¬† ¬† ¬† xs[i] = (i == <span class="hljs-number">1</span>) ? x‚ÇÄ : (œÅ*xs[i-<span class="hljs-number">1</span>] + œÉ*ŒΩs[i])
¬† ¬† <span class="hljs-keyword">end</span>
    xs + log.(œµs) + <span class="hljs-number">1.27</span>
<span class="hljs-keyword">end</span></code></pre>
<h2 id="future_work"><a href="#future_work" class="header-anchor">Future work</a></h2>
<ul>
<li><p>More involved models</p>
</li>
<li><p>Solving isolation in the three component normal mixture model</p>
</li>
<li><p>Updating shocks in every iteration</p>
</li>
<li><p>Optimization</p>
</li>
</ul>
<h2 id="references"><a href="#references" class="header-anchor">References</a></h2>
<ul>
<li><p>Betancourt, M. &#40;2017&#41;. A Conceptual Introduction to Hamiltonian Monte Carlo.</p>
</li>
<li><p>Drovandi, C. C., Pettitt, A. N., &amp; Lee, A. &#40;2015&#41;. Bayesian indirect inference using a parametric auxiliary model.</p>
</li>
<li><p>Gallant, A. R. and McCulloch, R. E. &#40;2009&#41;. On the Determination of General Scientific Models With Application to Asset Pricing</p>
</li>
<li><p>Martin, G. M., McCabe, B. P. M., Frazier, D. T., Maneesoonthorn, W. and Robert, C. P. &#40;2016&#41;. Auxiliary Likelihood-Based Approximate Bayesian Computation in State Space Models</p>
</li>
<li><p>Rayner, G. D. and MacGillivray, H. L. &#40;2002&#41;. Numerical maximum likelihood estimation for the g-and-k and generalized g-and-h distributions. In: Statistical Computation 12 57‚Äì75.</p>
</li>
<li><p>Smith, A. A. &#40;2008&#41;. ‚ÄúIndirect inference‚Äù. In: New Palgrave Dictionary of Economics, 2nd Edition &#40;forthcoming&#41;.</p>
</li>
<li><p>Smith, A. A. &#40;1993&#41;. ‚ÄúEstimating nonlinear time-series models using simulated vector autoregressions‚Äù. In Journal of Applied Econometrics 8.S1.</p>
</li>
</ul>
</div><br><br>

<!-- CONTENT ENDS HERE -->
    
        



    
    
        <script src="/previews/PR2358/libs/highlight/highlight.min.js"></script>


    

    <!-- http://tutsplus.github.io/clipboard/ -->

<script>
(function(){

	// Get the elements.
	// - the 'pre' element.
	// - the 'div' with the 'paste-content' id.

	var pre = document.getElementsByTagName('pre');

	// Add a copy button in the 'pre' element.
	// which only has the className of 'language-' or ' hljs'(if enable highlight.js pre-render).

	for (var i = 0; i < pre.length; i++) {
		var tag_name = pre[i].children[0].className
            	var isLanguage = tag_name.startsWith('language-') || tag_name.endsWith(' hljs');
		if ( isLanguage ) {
			var button           = document.createElement('button');
					button.className = 'copy-button';
					button.textContent = 'Copy';

					pre[i].appendChild(button);
		}
	};

	// Run Clipboard

	var copyCode = new Clipboard('.copy-button', {
		target: function(trigger) {
			return trigger.previousElementSibling;
    }
	});

	// On success:
	// - Change the "Copy" text to "Copied".
	// - Swap it to "Copy" in 2s.
	// - Lead user to the "contenteditable" area with Velocity scroll.

	copyCode.on('success', function(event) {
		event.clearSelection();
		event.trigger.textContent = 'Copied';
		window.setTimeout(function() {
			event.trigger.textContent = 'Copy';
		}, 2000);

	});

	// On error (Safari):
	// - Change the  "Press Ctrl+C to copy"
	// - Swap it to "Copy" in 2s.

	copyCode.on('error', function(event) {
		event.trigger.textContent = 'Press "Ctrl + C" to copy';
		window.setTimeout(function() {
			event.trigger.textContent = 'Copy';
		}, 5000);
	});

})();
</script>


    <footer class="container-fluid footer-copy">
  <div class="container">
    <div class="row footrow">
      <ul>
        <li><a href="/previews/PR2358/project">About</a></li>
        <li><a href="/previews/PR2358/about/help">Get Help</a></li>
        <li><a href="/previews/PR2358/governance/">Governance</a></li>
        <li><a href="/previews/PR2358/research/#publications">Publications</a></li>
        <li><a href="/previews/PR2358/community/sponsors/">Sponsors</a></li>
      </ul>
      <ul>
        <li><a href="/previews/PR2358/install/">Install</a></li>
        <li><a href="/previews/PR2358/downloads/">Manual Downloads</a></li>
        <li><a href="https://github.com/JuliaLang/julia">Source Code</a></li>
        <li><a href="/previews/PR2358/downloads/#current_stable_release">Current Stable Release</a></li>
        <li><a href="/previews/PR2358/downloads/#long_term_support_release">Longterm Support Release</a></li>
      </ul>
      <ul>
        <li><a href="https://docs.julialang.org/en/v1/">Documentation</a></li>
        <li><a href="https://juliaacademy.com">JuliaAcademy</a></li>
        <li><a href="https://www.youtube.com/user/JuliaLanguage">YouTube</a></li>
        <li><a href="/previews/PR2358/learning/getting-started/">Getting Started</a></li>
        <li><a href="https://docs.julialang.org/en/v1/manual/faq/">FAQ</a></li>
        <li><a href="/previews/PR2358/learning/books">Books</a></li>
      </ul>
      <ul>
        <li><a href="/previews/PR2358/community/">Community</a></li>
        <li><a href="/previews/PR2358/community/standards/">Code of Conduct</a></li>
        <li><a href="/previews/PR2358/community/stewards/">Stewards</a></li>
        <li><a href="/previews/PR2358/diversity/">Diversity</a></li>
        <li><a href="https://juliagenderinclusive.github.io">Julia Gender Inclusive</a></li>
        <li><a href="https://juliacon.org">JuliaCon</a></li>
        <li><a href="/previews/PR2358/community/#julia_user_and_developer_survey">User/Developer Survey</a></li>
        <li><a href="/previews/PR2358/shop/">Shop Merchandise</a></li>
      </ul>
      <ul>
        <li><a href="https://github.com/JuliaLang/julia/blob/master/CONTRIBUTING.md">Contributing</a></li>
        <li><a href="/previews/PR2358/contribute">Contributor's Guide</a></li>
        <li><a href="https://github.com/JuliaLang/julia/issues">Issue Tracker</a></li>
        <li><a href="https://github.com/JuliaLang/julia/security/policy">Report a Security Issue</a></li>
        <li><a href="https://github.com/search?q=is%3Aopen+is%3Aissue+language%3AJulia+label%3A%22help+wanted%22">Help Wanted Issues</a></li>
        <li><a href="https://github.com/search?q=is%3Aopen+is%3Aissue+language%3AJulia+label%3A%22good+first+issue%22">Good First Issue</a></li>
        <li><a href="https://docs.julialang.org/en/v1/devdocs/init/">Dev Docs</a></li>
      </ul>
    </div>
    <div id="footer-bottom" class="row">
      <div class="col-md-10 py-2">
        <p>This site is powered by <a href="https://www.netlify.com">Netlify</a>, <a href="https://franklinjl.org">Franklin.jl</a>, and the <a href="https://julialang.org">Julia Programming Language</a>.</p>
        <p>We thank <a href="https://www.fastly.com">Fastly</a> for their generous infrastructure support.</p>
        <p>¬©2024 JuliaLang.org <a href="https://github.com/JuliaLang/www.julialang.org/graphs/contributors">contributors</a>. The content on this website is made available under the <a href="https://github.com/JuliaLang/www.julialang.org/blob/master/LICENSE.md">MIT license</a>.</p>
      </div>
      <div class="col-md-2 py-2">
        <span class="float-sm-right">
          <a class="github-button" href="https://github.com/sponsors/julialang" data-icon="octicon-heart" data-size="large" aria-label="Sponsor @julialang on GitHub">Sponsor</a>
        </span>
      </div>
    </div>
  </div>
</footer>

<script src="/previews/PR2358/libs/jquery/jquery.min.js"></script>
<script src="/previews/PR2358/libs/bootstrap/bootstrap.min.js"></script>
<!-- <script src="/previews/PR2358/libs/highlight/highlight.min.js"></script> -->
<!--  -->

    <script src="/previews/PR2358/libs/groups.js"></script>
    <script src="/previews/PR2358/libs/map.js"></script>
  </body>
</html>
