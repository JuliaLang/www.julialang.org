<!doctype html>
<html lang="en">
<head>
	<!-- parts for all pages -->
	<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="author" content="Jeff Bezanson, Stefan Karpinski, Viral Shah, Alan Edelman, et al.">
<meta name="description" content="The official website for the Julia Language. Julia is a language that is fast, dynamic, easy to use, and open source. Click here to learn more.">
<meta name="robots" content="max-image-preview:large">
<meta name="twitter:site:id" content="1237720952"> <!-- @JuliaLanguage -->
<meta name="google-site-verification" content="9VDSjBtchQj6PQYIVwugTPY7pVCfLYgvkXiRHjc_Bzw" /> <!-- Google News Feed -->


	<link rel="icon" href="/previews/PR2358/assets/infra/julia.ico">

  <!-- Franklin stylesheets for generated pages -->
   <link rel="stylesheet" href="/previews/PR2358/libs/katex/katex.min.css">
      
   <link rel="stylesheet" href="/previews/PR2358/libs/highlight/github.min.css">
  

	<!-- NOTE: specific stylesheets -->
<link rel="stylesheet" href="/previews/PR2358/libs/bootstrap/bootstrap.min.css">
<link rel="stylesheet" href="/previews/PR2358/css/app.css">
<link rel="stylesheet" href="/previews/PR2358/css/franklin.css">
<link rel="stylesheet" href="/previews/PR2358/css/fonts.css">
<link href="https://fonts.googleapis.com/css?family=Roboto:400,400i,500,500i,700,700i" rel="stylesheet">
<link href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
<script async defer src="/previews/PR2358/libs/buttons.js"></script>
<script src="/previews/PR2358/libs/clipboard.min.js"></script>
<script src="/previews/PR2358/libs/detectdark.js"></script>


<script defer data-domain="julialang.org" src="https://plausible.io/js/script.js"></script>

<!-- scripts for map rendering -->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"
integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A=="
crossorigin=""/>

<script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"
 integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA=="
 crossorigin=""></script>

<!-- https://github.com/Leaflet/Leaflet.markercluster -->
<script src="https://cdn.jsdelivr.net/npm/leaflet.markercluster@1.4.1/dist/leaflet.markercluster-src.min.js"></script>

<script src="https://kit.fontawesome.com/f030d443fe.js" crossorigin="anonymous"></script>


   <title>Simulation of a swimming dogfish shark</title>   

  
  <style>
	  .container ul li p {margin-bottom: 0;}
		.container ol li p {margin-bottom: 0;}
		.container ul ul {margin: .4em 0 .4em 0;}
		.container ul ol {margin: .4em 0 .4em 0;}
		.container ol ul {margin: .4em 0 .4em 0;}
		.container ol ol {margin: .4em 0 .4em 0;}
  </style>
  

  <!-- Specific style for blog pages (except the /blob/index) -->
  
  <style>
    .main { font-family: Georgia; }
    .main pre {
  	  margin-left: auto;
  	  margin-right: auto;
    }
    .main { width: 100%; font-size: 100%; }
    .main code { font-size: 90%; }
    .main pre code { font-size: 90%; }
    @media (min-width: 940px) {
      .main { width: 800px; }
      .container.blog-title { width: 800px;}
    }
  </style>
  

  <!-- OGP Metadata -->
	<meta property="og:image" content="{{base}}slenderfish.jpg">
<meta name="twitter:creator:id" content="194427250">
<meta name="twitter:card" content="summary_large_image">
<meta property="og:title" content="Simulation of a swimming dogfish shark">
<meta property="og:description" content="Simulation of a swimming dogfish shark
">


</head>

<body>

<nav class="navbar navbar-expand-lg navbar-light bg-white" id="main-menu">
  <div class="container">
      <a class="navbar-brand" href="/previews/PR2358/">
          <img src="/previews/PR2358/assets/infra/logo.svg" alt="JuliaLang Logo" class="navbarjulialogo" height="40">
      </a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarContent" aria-controls="navbarContent" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarContent">
          <ul class="navbar-nav mx-auto mb-2 mb-lg-0">
              <li class="nav-item  ">
                  <a class="nav-link" href="/previews/PR2358/install/">Install</a>
              </li>
              <li class="nav-item">
                  <a class="nav-link" href="https://docs.julialang.org">Docs</a>
              </li>
              <li class="nav-item ">
                  <a class="nav-link" href="/previews/PR2358/learning/">Learn</a>
              </li>
              <li class="nav-item active">
                  <a class="nav-link" href="/previews/PR2358/blog/">Blog</a>
              </li>
              <li class="nav-item ">
                  <a class="nav-link" href="/previews/PR2358/community/">Community</a>
              </li>
              <li class="nav-item ">
                  <a class="nav-link" href="/previews/PR2358/contribute/">Contribute</a>
              </li>
              <li class="nav-item ">
                  <a class="nav-link" href="/previews/PR2358/jsoc/">JSoC</a>
              </li>
          </ul>
          <div class="navbar-action-buttons d-flex gap-4">
              <a class="github-button" href="https://github.com/JuliaLang/julia" data-icon="octicon-star" data-size="large" data-show-count="false" aria-label="Star JuliaLang/julia on GitHub">Star</a>
              <a class="github-button" href="https://github.com/sponsors/julialang" data-icon="octicon-heart" data-size="large" aria-label="Sponsor @julialang on GitHub">Sponsor</a>
          </div>
      </div>
  </div>
</nav>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>


<br><br>


<div class="container blog-title">
  <h1>Simulation of a swimming dogfish shark
    <a type="application/rss+xml" href="https://julialang.org/feed.xml">
      <i class="fa fa-rss-square rss-icon"></i>
    </a>
  </h1>
  <h3>
   <span style="font-weight: lighter;"> 12 August 2021 </span>
	|
	
	 <span style="font-weight: bold;">Gabriel D Weymouth<a href="https://twitter.com/intent/user?user_id=194427250"><img src="/previews/PR2358/assets/infra/twitter.svg"/ width="22px" height="22px" style="margin-left:2px"></a></span> 
  <!-- assumption that only one of the two is defined -->
  
  </h3>
</div>



<a href="https://github.com/JuliaLang/www.julialang.org/blob/master/blog/2021/08/sharks.md" title="Edit this page on GitHub" class="edit-float">
</a>


<!-- Content appended here -->
<div class="container main">
<p>This post will demonstrate how to set up and simulate a model of a swimming dogfish shark using <a href="https://julialang.org/">Julia</a> and <a href="https://www.youtube.com/watch?v&#61;YsPkfZqbNSQ">WaterLily.jl</a>. This post is adapted from a <a href="https://github.com/fonsp/Pluto.jl">Pluto</a> notebook that you can get <a href="/previews/PR2358/assets/blog/2021-08-sharks/notebook.jl">here</a>.</p>
<pre><code class="julia hljs"><span class="hljs-keyword">using</span> WaterLily, StaticArrays, PlutoUI, Interpolations, Plots, Images</code></pre>
<p>We&#39;ll use a simple model of the shark based on Lighthill&#39;s pioneering <a href="https://doi.org/10.1017/S0022112060001110">paper on the swimming of slender fish</a>. It focuses on the &quot;backbone&quot; of the fish; idealizing the shape as a thickness distribution on either side of the center, and the motion as a lateral &#40;&quot;side-to-side&quot;&#41; traveling wave. Amazingly, this simple approach provides insight across a huge range of a swimming animals as illustrated in the image below. <a href="https://www.nature.com/articles/nphys3078">Image credit: Gazzola et al, Nature 2014</a></p>
<p><img src="/previews/PR2358/assets/blog/2021-08-sharks/slenderfish.png" alt="" /></p>
<h2 id="modeling_the_sharks_thickness_and_motion"><a href="#modeling_the_sharks_thickness_and_motion" class="header-anchor">Modeling the shark&#39;s thickness and motion</a></h2>
<p>We&#39;ll define the thickness and motion distributions using interpolate to fit splines through a few points.</p>
<pre><code class="julia hljs">fit = y -&gt; scale(
        interpolate(y, BSpline(Quadratic(Line(OnGrid())))),
        range(<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,length=length(y))
    )</code></pre>
<p>Here is an image of the dogfish shark we will model. Image credit: Shark Trust.</p>
<pre><code class="julia hljs">url2 = <span class="hljs-string">&quot;https://pterosaurheresies.files.wordpress.com/2020/01/squalus-acanthias-invivo588.jpg&quot;</span>
filename2 = download(url2)
dogfish = load(filename2)</code></pre>
<p><img src="/previews/PR2358/assets/blog/2021-08-sharks/shark1.png" alt="" /></p>
<p>The bottom view shows the outline we&#39;re interested in, and adding a few points along the length defines the thickness distribution function <code>thk</code>.</p>
<pre><code class="julia hljs">plot(dogfish)
nose, len = (<span class="hljs-number">30</span>,<span class="hljs-number">224</span>), <span class="hljs-number">500</span>
width = [<span class="hljs-number">0.02</span>, <span class="hljs-number">0.07</span>, <span class="hljs-number">0.06</span>, <span class="hljs-number">0.048</span>, <span class="hljs-number">0.03</span>, <span class="hljs-number">0.019</span>, <span class="hljs-number">0.01</span>]
scatter!(
	nose[<span class="hljs-number">1</span>] .+ len .* range(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, length=length(width)),
	nose[<span class="hljs-number">2</span>] .- len .* width, color=:blue, legend=<span class="hljs-literal">false</span>)
thk = fit(width)
x = <span class="hljs-number">0</span>:<span class="hljs-number">0.01</span>:<span class="hljs-number">1</span>
plot!(
	nose[<span class="hljs-number">1</span>] .+ len .* x,
	[nose[<span class="hljs-number">2</span>] .- len .* thk.(x), nose[<span class="hljs-number">2</span>] .+ len .* thk.(x)],
	color=:blue)</code></pre>
<p><img src="/previews/PR2358/assets/blog/2021-08-sharks/shark2.svg" alt="" /></p>
<p>Looking at <a href="https://youtu.be/nMa6lD2CQVI?t&#61;200">videos of swimming dogfish</a>, we can see a couple general features</p>
<ul>
<li><p>The motion of the front half of the body has a small amplitude &#40;around 20&#37; of the tail&#41;. This sets the amplitude envelope for the traveling wave.</p>
</li>
</ul>
<pre><code class="julia hljs">envelope = [<span class="hljs-number">0.2</span>,<span class="hljs-number">0.21</span>,<span class="hljs-number">0.23</span>,<span class="hljs-number">0.4</span>,<span class="hljs-number">0.88</span>,<span class="hljs-number">1.0</span>]
amp = fit(envelope)</code></pre>
<ul>
<li><p>The wavelength of the traveling wave is a bit longer than the body length</p>
</li>
</ul>
<p>In the code below, you can change the value of <span class="katex"><span class="katex-mathml"><math xmlns="https://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">λ</span></span></span></span> to control the wavelength of the traveling wave to see the impact it has on the backbone over the motion cycle.</p>
<pre><code class="julia hljs">λ = <span class="hljs-number">1.4</span>
scatter(<span class="hljs-number">0</span>:<span class="hljs-number">0.2</span>:<span class="hljs-number">1</span>, envelope)
colors = palette(:cyclic_wrwbw_40_90_c42_n256)
<span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> <span class="hljs-number">1</span>/<span class="hljs-number">12</span>:<span class="hljs-number">1</span>/<span class="hljs-number">12</span>:<span class="hljs-number">1</span>
	plot!(x, amp.(x) .* sin.(<span class="hljs-number">2</span><span class="hljs-literal">π</span>/λ * x .- <span class="hljs-number">2</span><span class="hljs-literal">π</span>*t),
		  color=colors[floor(<span class="hljs-built_in">Int</span>,t*<span class="hljs-number">256</span>)])
<span class="hljs-keyword">end</span>
plot!(ylim=(-<span class="hljs-number">1.4</span>,<span class="hljs-number">1.4</span>), legend=<span class="hljs-literal">false</span>)</code></pre>
<p><img src="/previews/PR2358/assets/blog/2021-08-sharks/wavelength.svg" alt="" /></p>
<h2 id="setting_up_the_simulation"><a href="#setting_up_the_simulation" class="header-anchor">Setting up the simulation</a></h2>
<p>Now the thickness and motion are defined, but how will we apply these to a fluid simulation? <code>WaterLily</code> uses an <a href="https://eprints.soton.ac.uk/369635/">immersed boundary method</a> and <a href="https://en.wikipedia.org/wiki/Automatic_differentiation">automatic differentiation</a> to embed a body into the flow. The upshot is that we don&#39;t need to do any meshing; all we need is a signed distance function &#40;SDF&#41; to the surface.</p>
<p>Let&#39;s start by defining the SDF to the &quot;backbone&quot;, which is a line segment from <span class="katex"><span class="katex-mathml"><math xmlns="https://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><mn>0</mn><mo>…</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">x=0\ldots 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span></span></span></span>. <a href="https://www.youtube.com/watch?v&#61;PMltMdi1Wzg">See this great video from Inigo Quilez for a derivation of this sdf.</a>. The plot below shows the sdf and the zero contour, which is ... just a line segment.</p>
<p>Simple adjustments to the SDF give us more control of the shape and position. By shifting the y offset as <code>y &#61; y-shift</code>, we can move the body laterally. And by subtracting a thickness from the distance as <code>sdf &#61; sdf-thickness</code>, we can give the line some width. This is all we need to model the shark.</p>
<pre><code class="julia hljs">shift = <span class="hljs-number">0.5</span>
T = <span class="hljs-number">0.5</span>

<span class="hljs-keyword">function</span> segment_sdf(x, y)
	s = clamp(x, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>)          <span class="hljs-comment"># distance along the segment</span>
	y = y - shift               <span class="hljs-comment"># shift laterally</span>
	sdf = √sum(abs2, (x-s, y))  <span class="hljs-comment"># line segment SDF</span>
	<span class="hljs-keyword">return</span> sdf - T * thk(s)     <span class="hljs-comment"># subtract thickness</span>
<span class="hljs-keyword">end</span>

grid = -<span class="hljs-number">1</span>:<span class="hljs-number">0.05</span>:<span class="hljs-number">2</span>
contourf(grid, grid, segment_sdf, clim=(-<span class="hljs-number">1</span>,<span class="hljs-number">2</span>), linewidth=<span class="hljs-number">0</span>)
contour!(grid, grid, segment_sdf, levels=[<span class="hljs-number">0</span>], color=:black)  <span class="hljs-comment"># zero contour</span></code></pre>
<p><img src="/previews/PR2358/assets/blog/2021-08-sharks/contour.svg" alt="" /></p>
<p>With the basic SDF tested out, we are ready to set up the WaterLily simulation using the function <code>fish</code> defined below:</p>
<ul>
<li><p>The functions <code>thk</code> is passed in to create the <code>sdf</code> and the function <code>amp</code> is passed in to create the traveling wave <code>map</code>.</p>
</li>
<li><p>The only numerical parameter passed into <code>fish</code> is the length of the fish <code>L</code> measured in computational cells. This sets the resolution of the simulation and the size of the fluid arrays.</p>
</li>
<li><p>The other parameters are the tail amplitude <code>A</code> as a fraction of the length, the <a href="https://en.wikipedia.org/wiki/Strouhal_number">Stouhal number</a> which sets the motion frequency <code>ω</code>, and the <a href="https://en.wikipedia.org/wiki/Reynolds_number">Reynolds number</a> which sets the fluid viscosity <code>ν</code>.</p>
</li>
</ul>
<pre><code class="julia hljs"><span class="hljs-keyword">function</span> fish(thk, amp, k=<span class="hljs-number">5.3</span>; L=<span class="hljs-number">2</span>^<span class="hljs-number">6</span>, A=<span class="hljs-number">0.1</span>, St=<span class="hljs-number">0.3</span>, Re=<span class="hljs-number">1e4</span>)
	<span class="hljs-comment"># fraction along fish length</span>
	s(x) = clamp(x[<span class="hljs-number">1</span>]/L, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>)

	<span class="hljs-comment"># fish geometry: thickened line SDF</span>
	sdf(x,t) = √sum(abs2, x - L * SVector(s(x), <span class="hljs-number">0.</span>)) - L * thk(s(x))

	<span class="hljs-comment"># fish motion: travelling wave</span>
	U = <span class="hljs-number">1</span>
	ω = <span class="hljs-number">2</span><span class="hljs-literal">π</span> * St * U/(<span class="hljs-number">2</span>A * L)
	<span class="hljs-keyword">function</span> map(x, t)
		xc = x .- L <span class="hljs-comment"># shift origin</span>
		<span class="hljs-keyword">return</span> xc - SVector(<span class="hljs-number">0.</span>, A * L * amp(s(xc)) * sin(k*s(xc)-ω*t))
	<span class="hljs-keyword">end</span>

	<span class="hljs-comment"># make the fish simulation</span>
	<span class="hljs-keyword">return</span> Simulation((<span class="hljs-number">4</span>L+<span class="hljs-number">2</span>,<span class="hljs-number">2</span>L+<span class="hljs-number">2</span>), [U,<span class="hljs-number">0.</span>], L;
						ν=U*L/Re, body=AutoBody(sdf,map))
<span class="hljs-keyword">end</span>

<span class="hljs-comment"># Create the swimming shark</span>
L,A,St = <span class="hljs-number">3</span>*<span class="hljs-number">2</span>^<span class="hljs-number">5</span>,<span class="hljs-number">0.1</span>,<span class="hljs-number">0.3</span>
swimmer = fish(thk, amp; L, A, St);

<span class="hljs-comment"># Save a time span for one swimming cycle</span>
period = <span class="hljs-number">2</span>A/St
cycle = range(<span class="hljs-number">0</span>, <span class="hljs-number">23</span>/<span class="hljs-number">24</span>*period, length=<span class="hljs-number">24</span>)</code></pre>
<p>We can test our geometry by plotting the immersed boundary function <code>μ₀</code>; which equals 1 in the fluid and 0 in the body.</p>
<pre><code class="julia hljs"><span class="hljs-meta">@gif</span> <span class="hljs-keyword">for</span> t ∈ cycle
	measure!(swimmer, t*swimmer.L/swimmer.U)
	contour(swimmer.flow.μ₀[:,:,<span class="hljs-number">1</span>]&#x27;,
			aspect_ratio=:equal, legend=<span class="hljs-literal">false</span>, border=:none)
<span class="hljs-keyword">end</span></code></pre>
<p><img src="/previews/PR2358/assets/blog/2021-08-sharks/swimmer.gif" alt="" /></p>
<h2 id="running_visualizing_and_measuring_the_simulation"><a href="#running_visualizing_and_measuring_the_simulation" class="header-anchor">Running visualizing and measuring the simulation</a></h2>
<p>That animation of the motion looks great, so we are ready to run the flow simulator&#33;</p>
<p>The <code>sim_step&#33;&#40;sim, t, remeasure&#61;true&#41;</code> function runs the simulator up to time <code>t</code>, remeasuring the body position every time step. &#40;<code>remeasure&#61;false</code> by default since it takes a little extra computational time and isn&#39;t needed for statics geometries.&#41;</p>
<pre><code class="julia hljs"><span class="hljs-comment"># run the simulation a few cycles (this takes few seconds)</span>
sim_step!(swimmer, <span class="hljs-number">10</span>, remeasure=<span class="hljs-literal">true</span>)
sim_time(swimmer)</code></pre>
<p>The simulation has now run forward in time, but there are no visualizations or measurements by default.</p>
<p>To see what is going on, lets make a gif of the vorticity <code>ω&#61;curl&#40;u&#41;</code> to visualize the vortices in the wake of the shark. This requires simulating a cycle of motion, and computing the <code>curl</code> at all the points <code>@inside</code> the simulation.</p>
<pre><code class="julia hljs"><span class="hljs-comment"># plot the vorcity ω=curl(u) scaled by the body length L and flow speed U</span>
<span class="hljs-keyword">function</span> plot_vorticity(sim)
	<span class="hljs-meta">@inside</span> sim.flow.σ[I] = WaterLily.curl(<span class="hljs-number">3</span>, I, sim.flow.u) * sim.L / sim.U
	contourf(sim.flow.σ&#x27;,
			 color=palette(:BuGn), clims=(-<span class="hljs-number">10</span>, <span class="hljs-number">10</span>), linewidth=<span class="hljs-number">0</span>,
			 aspect_ratio=:equal, legend=<span class="hljs-literal">false</span>, border=:none)
<span class="hljs-keyword">end</span>

<span class="hljs-comment"># make a gif over a swimming cycle</span>
<span class="hljs-meta">@gif</span> <span class="hljs-keyword">for</span> t ∈ sim_time(swimmer) .+ cycle
	sim_step!(swimmer, t, remeasure=<span class="hljs-literal">true</span>)
	plot_vorticity(swimmer)
<span class="hljs-keyword">end</span></code></pre>
<p><img src="/previews/PR2358/assets/blog/2021-08-sharks/swimmer2.gif" alt="" /></p>
<p>This is pretty &#40;CFD does stand for <em>Colorful Fluid Dynamics</em> after all&#41;, but also tells us something important about the flow. Notice that there are no eddies coming off the body anywhere other than the tail&#33; This is a sign of efficiency since energy is only used to create those trailing vortices.</p>
<p>We can dig in and get some quantitative measurements from the simulation as well. The function <code>∮nds</code> takes a integral over the body surface. By passing in the pressure <code>p</code>, we can measure the thrust force and side force generated by the shark&#33;</p>
<pre><code class="julia hljs"><span class="hljs-keyword">function</span> get_force(sim, t)
	sim_step!(sim, t, remeasure=<span class="hljs-literal">true</span>)
	<span class="hljs-keyword">return</span> WaterLily.∮nds(sim.flow.p, sim.body, t*sim.L/sim.U) ./ (<span class="hljs-number">0.5</span>*sim.L*sim.U^<span class="hljs-number">2</span>)
<span class="hljs-keyword">end</span>
forces = [get_force(swimmer, t) <span class="hljs-keyword">for</span> t ∈ sim_time(swimmer) .+ cycle]

scatter(cycle./period, [first.(forces), last.(forces)],
		labels=permutedims([<span class="hljs-string">&quot;thrust&quot;</span>, <span class="hljs-string">&quot;side&quot;</span>]),
		xlabel=<span class="hljs-string">&quot;scaled time&quot;</span>,
		ylabel=<span class="hljs-string">&quot;scaled force&quot;</span>)</code></pre>
<p><img src="/previews/PR2358/assets/blog/2021-08-sharks/forces.svg" alt="" /></p>
<p>We can learn a lot from this simple plot. For example, the side-to-side force has the same frequency as the swimming motion itself while the thrust force has double the frequency, with a peak every time the tail passes through the centerline.</p>
<h2 id="next_steps"><a href="#next_steps" class="header-anchor">Next steps</a></h2>
<p>This simple model is a great start and it opens up a ton of avenues for improving the shark simulation and suggesting research questions:</p>
<ul>
<li><p>The instantaneous net forces should be zero in a free swimming body&#33; We could add reaction motions to our model to achieve this. Would the model shark swim in a straight line if we did this, or is a control-loop needed?</p>
</li>
<li><p>Real sharks are 3D &#40;gasp&#33;&#41;. While we could easily extend this approach using 2D splines, it will take much longer to simulate. Is there a way use GPUs to accelerate the simulations without completely changing the solver?</p>
</li>
<li><p>If we were going to make a bio-inspired robot of this shark, we will have constraints on the shape and motion and powering available. Can we use this framework to help optimize our robotic within it&#39;s constraints?</p>
</li>
</ul>
<p>Below you can find links to all the packages used in this notebook. Happy Simulating&#33;</p>
<ol>
<li><p><a href="https://juliamath.github.io/Interpolations.jl/stable/">Interpolations.jl</a></p>
</li>
<li><p><a href="https://juliadiff.org/">JuliaDiff</a></p>
</li>
<li><p><a href="https://juliaimages.org/stable/">JuliaImages</a></p>
</li>
<li><p><a href="http://docs.juliaplots.org/latest/">Plots.jl</a></p>
</li>
<li><p><a href="https://github.com/fonsp/Pluto.jl">Pluto.jl</a> and <a href="https://github.com/fonsp/PlutoUI.jl">PlutoUI.jl</a></p>
</li>
<li><p><a href="https://github.com/JuliaArrays/StaticArrays.jl">StaticArrays.jl</a></p>
</li>
<li><p><a href="https://github.com/weymouth/WaterLily.jl">WaterLily.jl</a></p>
</li>
</ol>
		<div class="author-info">
          <img src="/previews/PR2358/assets/blog/2021-08-sharks/GWeymouth.jpg" class="author-img" alt="Gabriel D Weymouth" width="150px">
		  <h3>Gabriel D Weymouth</h3>
		  <div class="author-description">
		    Associate Professor of Marine Hydrodynamics at University of Southampton

		  </div>
          <div class="author-social">
            <ul class="author-social-icons">
            <li class="author-social-link-twitter">
  <a href="https://twitter.com/intent/user?user_id=194427250"><i class="fa fa-twitter"></i></a>
</li>

            </ul>
		  </div>
		</div>
		
</div><br><br>

<!-- CONTENT ENDS HERE -->
    
        



    
    
        <script src="/previews/PR2358/libs/highlight/highlight.min.js"></script>


    

    <!-- http://tutsplus.github.io/clipboard/ -->

<script>
(function(){

	// Get the elements.
	// - the 'pre' element.
	// - the 'div' with the 'paste-content' id.

	var pre = document.getElementsByTagName('pre');

	// Add a copy button in the 'pre' element.
	// which only has the className of 'language-' or ' hljs'(if enable highlight.js pre-render).

	for (var i = 0; i < pre.length; i++) {
		var tag_name = pre[i].children[0].className
            	var isLanguage = tag_name.startsWith('language-') || tag_name.endsWith(' hljs');
		if ( isLanguage ) {
			var button           = document.createElement('button');
					button.className = 'copy-button';
					button.textContent = 'Copy';

					pre[i].appendChild(button);
		}
	};

	// Run Clipboard

	var copyCode = new Clipboard('.copy-button', {
		target: function(trigger) {
			return trigger.previousElementSibling;
    }
	});

	// On success:
	// - Change the "Copy" text to "Copied".
	// - Swap it to "Copy" in 2s.
	// - Lead user to the "contenteditable" area with Velocity scroll.

	copyCode.on('success', function(event) {
		event.clearSelection();
		event.trigger.textContent = 'Copied';
		window.setTimeout(function() {
			event.trigger.textContent = 'Copy';
		}, 2000);

	});

	// On error (Safari):
	// - Change the  "Press Ctrl+C to copy"
	// - Swap it to "Copy" in 2s.

	copyCode.on('error', function(event) {
		event.trigger.textContent = 'Press "Ctrl + C" to copy';
		window.setTimeout(function() {
			event.trigger.textContent = 'Copy';
		}, 5000);
	});

})();
</script>


    <footer class="container-fluid footer-copy">
  <div class="container">
    <div class="row footrow">
      <ul>
        <li><a href="/previews/PR2358/project">About</a></li>
        <li><a href="/previews/PR2358/about/help">Get Help</a></li>
        <li><a href="/previews/PR2358/governance/">Governance</a></li>
        <li><a href="/previews/PR2358/research/#publications">Publications</a></li>
        <li><a href="/previews/PR2358/community/sponsors/">Sponsors</a></li>
      </ul>
      <ul>
        <li><a href="/previews/PR2358/install/">Install</a></li>
        <li><a href="/previews/PR2358/downloads/">Manual Downloads</a></li>
        <li><a href="https://github.com/JuliaLang/julia">Source Code</a></li>
        <li><a href="/previews/PR2358/downloads/#current_stable_release">Current Stable Release</a></li>
        <li><a href="/previews/PR2358/downloads/#long_term_support_release">Longterm Support Release</a></li>
      </ul>
      <ul>
        <li><a href="https://docs.julialang.org/en/v1/">Documentation</a></li>
        <li><a href="https://juliaacademy.com">JuliaAcademy</a></li>
        <li><a href="https://www.youtube.com/user/JuliaLanguage">YouTube</a></li>
        <li><a href="/previews/PR2358/learning/getting-started/">Getting Started</a></li>
        <li><a href="https://docs.julialang.org/en/v1/manual/faq/">FAQ</a></li>
        <li><a href="/previews/PR2358/learning/books">Books</a></li>
      </ul>
      <ul>
        <li><a href="/previews/PR2358/community/">Community</a></li>
        <li><a href="/previews/PR2358/community/standards/">Code of Conduct</a></li>
        <li><a href="/previews/PR2358/community/stewards/">Stewards</a></li>
        <li><a href="/previews/PR2358/diversity/">Diversity</a></li>
        <li><a href="https://juliagenderinclusive.github.io">Julia Gender Inclusive</a></li>
        <li><a href="https://juliacon.org">JuliaCon</a></li>
        <li><a href="/previews/PR2358/community/#julia_user_and_developer_survey">User/Developer Survey</a></li>
        <li><a href="/previews/PR2358/shop/">Shop Merchandise</a></li>
      </ul>
      <ul>
        <li><a href="https://github.com/JuliaLang/julia/blob/master/CONTRIBUTING.md">Contributing</a></li>
        <li><a href="/previews/PR2358/contribute">Contributor's Guide</a></li>
        <li><a href="https://github.com/JuliaLang/julia/issues">Issue Tracker</a></li>
        <li><a href="https://github.com/JuliaLang/julia/security/policy">Report a Security Issue</a></li>
        <li><a href="https://github.com/search?q=is%3Aopen+is%3Aissue+language%3AJulia+label%3A%22help+wanted%22">Help Wanted Issues</a></li>
        <li><a href="https://github.com/search?q=is%3Aopen+is%3Aissue+language%3AJulia+label%3A%22good+first+issue%22">Good First Issue</a></li>
        <li><a href="https://docs.julialang.org/en/v1/devdocs/init/">Dev Docs</a></li>
      </ul>
    </div>
    <div id="footer-bottom" class="row">
      <div class="col-md-10 py-2">
        <p>This site is powered by <a href="https://www.netlify.com">Netlify</a>, <a href="https://franklinjl.org">Franklin.jl</a>, and the <a href="https://julialang.org">Julia Programming Language</a>.</p>
        <p>We thank <a href="https://www.fastly.com">Fastly</a> for their generous infrastructure support.</p>
        <p>©2024 JuliaLang.org <a href="https://github.com/JuliaLang/www.julialang.org/graphs/contributors">contributors</a>. The content on this website is made available under the <a href="https://github.com/JuliaLang/www.julialang.org/blob/master/LICENSE.md">MIT license</a>.</p>
      </div>
      <div class="col-md-2 py-2">
        <span class="float-sm-right">
          <a class="github-button" href="https://github.com/sponsors/julialang" data-icon="octicon-heart" data-size="large" aria-label="Sponsor @julialang on GitHub">Sponsor</a>
        </span>
      </div>
    </div>
  </div>
</footer>

<script src="/previews/PR2358/libs/jquery/jquery.min.js"></script>
<script src="/previews/PR2358/libs/bootstrap/bootstrap.min.js"></script>
<!-- <script src="/previews/PR2358/libs/highlight/highlight.min.js"></script> -->
<!--  -->

    <script src="/previews/PR2358/libs/groups.js"></script>
    <script src="/previews/PR2358/libs/map.js"></script>
  </body>
</html>
